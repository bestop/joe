---
layout: post
published: true
title: 如何为Blogger添加最新评论
tags: 信息||Info    
permalink: /2009-07-21-如何为blogger添加最新评论.html
description:       从blogger后台进入"布局-页面元素"。     点击侧边栏"添加小工具"，增加一个"HTML/JavaScript"。     在"内容"中填入下面代码，其中加粗内容控制了第一评论和每页显示数量。    &lt;div&nbsp;id="newComments"&gt;&nbsp;&nbsp;&lt
summary: <FONT size=2>  <OL>    <LI>从blogger后台进入"布局-页面元素"。     <LI>点击侧边栏"添加小工具"，增加一个"HTML/JavaScript"。     <LI>在"内容"中填入下面代码，其中加粗内容控制了第一评论和每页显示数量。<BR>    <BLOCKQUOTE>&lt;div&nbsp;id="newComments"&gt;<BR>&nbsp;&nbsp;&lt;noscript&gt;failed!&lt;br/&gt;Javascript&
---
  <div class="post"><div><FONT size=2>  <OL>    <LI>从blogger后台进入"布局-页面元素"。     <LI>点击侧边栏"添加小工具"，增加一个"HTML/JavaScript"。     <LI>在"内容"中填入下面代码，其中加粗内容控制了第一评论和每页显示数量。<BR>    <BLOCKQUOTE>&lt;div&nbsp;id="newComments"&gt;<BR>&nbsp;&nbsp;&lt;noscript&gt;failed!&lt;br/&gt;Javascript&nbsp;not&nbsp;supported&nbsp;here!&lt;/noscript&gt;<BR>&lt;/div&gt;<BR><BR>&lt;script&gt;<BR><B>var&nbsp;nCommentStartIndex&nbsp;=&nbsp;1;<BR>var&nbsp;nCommentShow&nbsp;=&nbsp;6;</B><BR><BR>function&nbsp;showRecentComments(nIndex)&nbsp;{<BR>&nbsp;&nbsp;if&nbsp;(!nIndex)<BR>&nbsp;&nbsp;&nbsp;&nbsp;nIndex&nbsp;=&nbsp;nCommentStartIndex;<BR>&nbsp;&nbsp;var&nbsp;sFeedURL&nbsp;=&nbsp;'/feeds/comments/summary?orderby=published&amp;start-index='+nIndex+'&amp;max-results='+(nCommentShow+1)+'&amp;alt=json-in-script&amp;callback=generateComments';<BR>&nbsp;&nbsp;var&nbsp;script&nbsp;=&nbsp;document.createElement('script');<BR>&nbsp;&nbsp;document.getElementById('newComments').innerHTML&nbsp;=&nbsp;'Loading&nbsp;&lt;blink&gt;...&lt;/blink&gt;';<BR>&nbsp;&nbsp;script.setAttribute('src',&nbsp;sFeedURL);<BR>&nbsp;&nbsp;script.setAttribute('type',&nbsp;'text/javascript');<BR>&nbsp;&nbsp;document.documentElement.firstChild.appendChild(script);<BR>}<BR><BR>function&nbsp;generateComments(json)&nbsp;{<BR>&nbsp;&nbsp;function&nbsp;compareentry(a,b)&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;order=&nbsp;Date.parse(a.published.$t.replace(/^(\d{4})-(\d{2})-(\d{2})T([0-9:]*)([.0-9]*)(.)(.*)$/,&nbsp;'$1/$2/$3&nbsp;$4&nbsp;GMT'))&nbsp;-&nbsp;Date.parse(b.published.$t.replace(/^(\d{4})-(\d{2})-(\d{2})T([0-9:]*)([.0-9]*)(.)(.*)$/,&nbsp;'$1/$2/$3&nbsp;$4&nbsp;GMT'));<BR>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0-order;<BR>&nbsp;&nbsp;}<BR>&nbsp;<BR>&nbsp;&nbsp;var&nbsp;sHTML&nbsp;=&nbsp;'&lt;ul&gt;';<BR>&nbsp;&nbsp;var&nbsp;sortentry&nbsp;=&nbsp;json.feed.entry.sort(compareentry);<BR>&nbsp;&nbsp;var&nbsp;nIndex&nbsp;=&nbsp;parseInt(json.feed.openSearch$startIndex.$t);<BR>&nbsp;&nbsp;var&nbsp;nTotalComment&nbsp;=&nbsp;parseInt(json.feed.openSearch$totalResults.$t);<BR>&nbsp;&nbsp;for&nbsp;(var&nbsp;i&nbsp;=&nbsp;0,&nbsp;Comment;&nbsp;Comment&nbsp;=&nbsp;sortentry[i];&nbsp;i++)&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(i&nbsp;&gt;=&nbsp;nCommentShow)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<BR>&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;authorname&nbsp;=&nbsp;Comment.author[0].name.$t;<BR>&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;title&nbsp;=&nbsp;Comment.title.$t.substr(0,30);<BR>&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;j&nbsp;=&nbsp;0;<BR>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(j&nbsp;&lt;&nbsp;Comment.link.length&nbsp;&amp;&amp;&nbsp;Comment.link[j].rel&nbsp;!=&nbsp;"alternate")<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j++;<BR>&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;link&nbsp;=&nbsp;Comment.link[j].href;<BR>&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;timestamp&nbsp;=&nbsp;Comment.published.$t.substr(0,10);<BR>&nbsp;&nbsp;&nbsp;&nbsp;sHTML&nbsp;+=&nbsp;'&lt;li&gt;&lt;span&nbsp;class="item-title"&gt;'+authorname+':&nbsp;&lt;a&nbsp;href="'+link+'"&gt;'+&nbsp;title&nbsp;+'&lt;/a&gt;&nbsp;-&nbsp;'+timestamp+'&lt;/span&gt;&lt;/li&gt;';<BR>&nbsp;&nbsp;}<BR>&nbsp;&nbsp;sHTML&nbsp;+=&nbsp;'&lt;/ul&gt;';<BR>&nbsp;&nbsp;sHTML&nbsp;+=&nbsp;generateCommentLink(parseInt(json.feed.entry.length),&nbsp;nIndex,&nbsp;nTotalComment);<BR>&nbsp;&nbsp;document.getElementById('newComments').innerHTML&nbsp;=&nbsp;sHTML;<BR>}<BR><BR>function&nbsp;generateCommentLink(nFetch,&nbsp;nIndex,&nbsp;nTotalComment)&nbsp;{<BR>&nbsp;&nbsp;var&nbsp;bOld&nbsp;=&nbsp;(nFetch&nbsp;&gt;&nbsp;nCommentShow);<BR>&nbsp;&nbsp;if&nbsp;(bOld)&nbsp;nFetch&nbsp;=&nbsp;nCommentShow;<BR>&nbsp;&nbsp;var&nbsp;sResult&nbsp;=&nbsp;'&lt;p&nbsp;align="right"&gt;Recent&nbsp;'+nIndex+'-'+(nIndex+nFetch-1)+',&nbsp;total:&nbsp;'+nTotalComment+'.&nbsp;&nbsp;';<BR>&nbsp;&nbsp;if&nbsp;(nIndex&nbsp;&gt;&nbsp;nCommentStartIndex)<BR>&nbsp;&nbsp;&nbsp;&nbsp;sResult&nbsp;+=&nbsp;'&lt;a&nbsp;href="javascript:showRecentComments('+(nIndex-nCommentShow)+');"&nbsp;title="Newer&nbsp;Comments"&gt;&lt;&lt;&lt;/a&gt;&nbsp;&nbsp;';<BR>&nbsp;&nbsp;if&nbsp;(bOld)<BR>&nbsp;&nbsp;&nbsp;&nbsp;sResult&nbsp;+=&nbsp;'&lt;a&nbsp;href="javascript:showRecentComments('+(nIndex+nCommentShow)+');"&nbsp;title="Older&nbsp;Comments"&gt;&gt;&gt;&lt;/a&gt;';<BR>&nbsp;&nbsp;sResult&nbsp;+=&nbsp;'&lt;/p&gt;';&nbsp;<BR>&nbsp;&nbsp;return&nbsp;sResult;<BR>}<BR>&lt;/script&gt;<BR><BR>&lt;script&nbsp;language="javascript"&gt;showRecentComments();&lt;/script&gt;</BLOCKQUOTE>    <LI>    <BLOCKQUOTE>更改标题为"最新评论"。 </BLOCKQUOTE>    <LI>    <BLOCKQUOTE>保存。</BLOCKQUOTE></LI></OL></FONT></div>
   
    
    
      
    </p>
    
    </div>
